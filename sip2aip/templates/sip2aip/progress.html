{% extends "earkweb/base.html" %}
{% load dictionary_extras %}

{% load staticfiles %}

{% block extra_head %}
<script type="text/javascript" src="{% static 'sip2aip/js/progress.js' %}"></script>
<link rel="stylesheet" href="{% static 'sip2aip/css/progress.css' %}" type="text/css" />
{% if task_id %}
<script type="text/javascript">pollstate('{{ task_id }}');</script>
{% endif %}
{% endblock %}

{% block content %}

  <div id="container">
  <div id="action" class="form-group">
      <form method="POST" onsubmit="return false">

    {% csrf_token %}
    <ul>{{ form.as_ul }}</ul>

    <br/><br/>
    <button id="apply-task">Apply task!</button>
  </form>
  </div>
<hr/>
  <div class="progress_container">

   <div class="current-task">
    <h4>{% if task_id %} Task ID: {{ task_id }} {% endif %}</h4>
   </div>

    <div id="st" class="status"></div>
    <div class="progress">
      <div id="pg" class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
    </div>

    <script>
    $('#apply-task').click( function() {
       $.ajax({
        url: "apply_task",
        data: {'selected_ip': $( "#id_ips" ).val(),'selected_action': $( "#id_wfs" ).val()},
        success: function(){
         $.ajax({
          url: "",
          context: document.body,
          success: function(s, x) {
           $(this).html(s);
          }
         });
        }
       })
    });
    </script>

 </div>
{% endblock %}
